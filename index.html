<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Primary Meta Tags -->
    <title>转 专砖 " 住祝" - 砖 '  专拽</title>
    <meta name="title" content="转 专砖  住祝 - 砖 '  专拽" />
    <meta name="description" content="转 专砖  住祝 - 专 转专 砖 ' 住, 注 转 26  专拽. 砖注专 转专, 转驻转 驻注转 拽转转." />
    <meta name="keywords" content="转 专砖,  住祝, 砖 ,  专拽, 转专, 转驻, 砖注专, 拽, 注 转" />
    <meta name="author" content="转 专砖  住祝" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://chazonyosef.netlify.app/" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://chazonyosef.netlify.app/" />
    <meta property="og:title" content="转 专砖  住祝 - 砖 '  专拽" />
    <meta property="og:description" content="转 专砖  住祝 - 专 转专 砖 ' 住, 注 转 26  专拽" />
    <meta property="og:image" content="https://chazonyosef.netlify.app/logo.png" />
    <meta property="og:locale" content="he_IL" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://chazonyosef.netlify.app/" />
    <meta property="twitter:title" content="转 专砖  住祝 - 砖 '  专拽" />
    <meta property="twitter:description" content="转 专砖  住祝 - 专 转专 砖 ' 住, 注 转 26  专拽" />
    <meta property="twitter:image" content="https://chazonyosef.netlify.app/logo.png" />
    
    <!-- Geo Tags -->
    <meta name="geo.region" content="IL" />
    <meta name="geo.placename" content=" 专拽" />
    <meta name="geo.position" content="32.0809;34.8338" />
    <meta name="ICBM" content="32.0809, 34.8338" />
    
    <!-- Google Fonts - Hebrew Support -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&family=Assistant:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    
    <!-- Preload Colors from localStorage to prevent flash -->
    <script>
      (function() {
        try {
          const saved = localStorage.getItem('siteSettings');
          if (saved) {
            const settings = JSON.parse(saved);
            if (settings.colors) {
              const root = document.documentElement;
              
              // Helper function to convert HEX to RGB string
              function hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                  r: parseInt(result[1], 16),
                  g: parseInt(result[2], 16),
                  b: parseInt(result[3], 16)
                } : null;
              }
              
              function hexToRgbString(hex) {
                const rgb = hexToRgb(hex);
                return rgb ? `${rgb.r} ${rgb.g} ${rgb.b}` : '0 0 0';
              }
              
              function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
              }
              
              // Generate shades
              function generateShades(baseColor) {
                const rgb = hexToRgb(baseColor);
                if (!rgb) return {};
                
                const shades = {};
                
                // Lighter shades
                const lighterSteps = [
                  { key: '50', mix: 0.95 },
                  { key: '100', mix: 0.9 },
                  { key: '200', mix: 0.75 },
                  { key: '300', mix: 0.6 },
                  { key: '400', mix: 0.3 }
                ];
                
                lighterSteps.forEach(({ key, mix }) => {
                  const r = Math.round(rgb.r + (255 - rgb.r) * mix);
                  const g = Math.round(rgb.g + (255 - rgb.g) * mix);
                  const b = Math.round(rgb.b + (255 - rgb.b) * mix);
                  shades[key] = rgbToHex(r, g, b);
                });
                
                shades['500'] = baseColor;
                
                // Darker shades
                const darkerSteps = [
                  { key: '600', mix: 0.2 },
                  { key: '700', mix: 0.4 },
                  { key: '800', mix: 0.6 },
                  { key: '900', mix: 0.8 }
                ];
                
                darkerSteps.forEach(({ key, mix }) => {
                  const r = Math.round(rgb.r * (1 - mix));
                  const g = Math.round(rgb.g * (1 - mix));
                  const b = Math.round(rgb.b * (1 - mix));
                  shades[key] = rgbToHex(r, g, b);
                });
                
                return shades;
              }
              
              // Apply colors immediately
              if (settings.colors.primary) {
                const primaryShades = generateShades(settings.colors.primary);
                Object.entries(primaryShades).forEach(([shade, color]) => {
                  root.style.setProperty(`--color-primary-${shade}`, hexToRgbString(color));
                });
                root.style.setProperty('--color-primary', hexToRgbString(settings.colors.primary));
              }
              
              if (settings.colors.secondary) {
                const secondaryShades = generateShades(settings.colors.secondary);
                Object.entries(secondaryShades).forEach(([shade, color]) => {
                  root.style.setProperty(`--color-secondary-${shade}`, hexToRgbString(color));
                });
                root.style.setProperty('--color-secondary', hexToRgbString(settings.colors.secondary));
              }
              
              if (settings.colors.accent) {
                const accentShades = generateShades(settings.colors.accent);
                Object.entries(accentShades).forEach(([shade, color]) => {
                  root.style.setProperty(`--color-accent-${shade}`, hexToRgbString(color));
                });
                root.style.setProperty('--color-accent', hexToRgbString(settings.colors.accent));
              }
              
              console.log(' Colors preloaded from localStorage');
            }
            
            // Preload font (async, non-blocking)
            if (settings.font) {
              const fontMap = {
                'Assistant': 'Assistant, sans-serif',
                'Rubik': 'Rubik, sans-serif',
                'Heebo': 'Heebo, sans-serif',
                'Varela Round': 'Varela Round, sans-serif',
                'Alef': 'Alef, sans-serif',
                'Open Sans': 'Open Sans, sans-serif',
                'Secular One': 'Secular One, sans-serif',
                'Arimo': 'Arimo, sans-serif',
                'Frank Ruhl Libre': 'Frank Ruhl Libre, serif',
                'Tinos': 'Tinos, serif'
              };
              
              const googleFontMap = {
                'Assistant': 'Assistant:wght@300;400;500;600;700;800',
                'Rubik': 'Rubik:wght@300;400;500;600;700;800;900',
                'Heebo': 'Heebo:wght@100;200;300;400;500;600;700;800;900',
                'Varela Round': 'Varela+Round',
                'Alef': 'Alef:wght@400;700',
                'Open Sans': 'Open+Sans:wght@300;400;500;600;700;800',
                'Secular One': 'Secular+One',
                'Arimo': 'Arimo:wght@400;500;600;700',
                'Frank Ruhl Libre': 'Frank+Ruhl+Libre:wght@300;400;500;700;900',
                'Tinos': 'Tinos:wght@400;700'
              };
              
              const fontValue = fontMap[settings.font];
              const googleFont = googleFontMap[settings.font];
              
              if (fontValue && googleFont) {
                // Apply font CSS variable immediately
                document.documentElement.style.setProperty('--font-family', fontValue);
                
                // Load Google Font asynchronously (non-blocking)
                setTimeout(function() {
                  const existingLink = document.getElementById('preload-font-link');
                  if (existingLink) {
                    existingLink.remove();
                  }
                  
                  const link = document.createElement('link');
                  link.id = 'preload-font-link';
                  link.rel = 'stylesheet';
                  link.href = `https://fonts.googleapis.com/css2?family=${googleFont}&display=swap`;
                  link.media = 'print';
                  link.onload = function() { this.media = 'all'; };
                  document.head.appendChild(link);
                  
                  console.log(' Font preloaded from localStorage:', settings.font);
                }, 0);
              }
            }
          }
        } catch (error) {
          console.error('Error preloading settings:', error);
        }
      })();
    </script>
    
    <!-- Structured Data (Schema.org) for Google -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Synagogue",
      "name": "转 专砖  住祝",
      "alternateName": "Beit Hamidrash Chazon Yosef",
      "description": "转 专砖 专 转专 砖 ' 住,  专拽",
      "url": "https://chazonyosef.netlify.app",
      "logo": "https://chazonyosef.netlify.app/logo.png",
      "image": "https://chazonyosef.netlify.app/logo.png",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "注 转 26",
        "addressLocality": " 专拽",
        "addressRegion": "转 ",
        "postalCode": "5126001",
        "addressCountry": "IL"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": "32.0809",
        "longitude": "34.8338"
      },
      "telephone": "+972-XX-XXX-XXXX",
      "openingHoursSpecification": [
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday"],
          "opens": "06:00",
          "closes": "23:00"
        }
      ],
      "sameAs": [
        "https://chazonyosef.netlify.app"
      ]
    }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
    
    <script>
      // Netlify Identity redirect handling
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
          if (!user) {
            window.netlifyIdentity.on("login", () => {
              document.location.href = "/admin";
            });
          }
        });
      }
    </script>
  </body>
</html>
